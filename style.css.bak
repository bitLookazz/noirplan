/* NoirPlan — deep black, no blue, real frosted glass */
:root{
  --bg0:#000; --bg1:#060608; --bg2:#0a0a0f; --ink:#e9e9ee; --muted:#a4a4b4; --hair:rgba(255,255,255,.07);
  --acc:#b06bf3; --acc2:#f05aa6;
  --glass:rgba(255,255,255,.06);
  --blur:14px; --sat:140%; --r:18px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;
  background:
    radial-gradient(1200px 800px at 85% -10%, rgba(240,90,166,.12), transparent 60%),
    radial-gradient(1200px 800px at 10% 110%, rgba(176,107,243,.10), transparent 60%),
    radial-gradient(600px 400px at 50% 20%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(180deg, var(--bg1), var(--bg2));
  position:relative;
}
body:before{
  content:"";position:fixed;inset:0;pointer-events:none;opacity:.06;mix-blend-mode:soft-light;
  background-image: repeating-radial-gradient(circle at 0 0, #000 0, #000 2px, #111 2px, #111 3px);
}
.top{
  position:sticky;top:0;z-index:5;display:flex;gap:12px;align-items:center;justify-content:space-between;
  padding:12px 14px;border-bottom:1px solid var(--hair);
  background:linear-gradient(180deg, rgba(0,0,0,.7), rgba(0,0,0,.35));
  backdrop-filter: blur(var(--blur)) saturate(var(--sat));
}
.brand{display:flex;align-items:center;gap:10px}
.logo{width:12px;height:12px;border-radius:50%;
  background: conic-gradient(from 210deg, var(--acc), var(--acc2));
  box-shadow:0 0 18px rgba(176,107,243,.45), 0 0 34px rgba(240,90,166,.25);
}
h1{margin:0;font-size:18px;letter-spacing:.4px}
.search{
  flex:1;max-width:52%;background:rgba(255,255,255,.03);color:var(--ink);
  border:1px solid var(--hair);border-radius:999px;padding:10px 14px;outline:none;
  backdrop-filter: blur(10px) saturate(120%);
}
.search:focus{border-color:transparent; box-shadow:0 0 0 2px rgba(176,107,243,.35), 0 0 28px rgba(176,107,243,.2) inset;}
.view{padding:14px 14px 110px 14px;max-width:960px;margin:0 auto}
.section{margin-bottom:16px}
.h2{margin:0 0 8px 2px;font-size:14px;color:var(--muted)}
.glass{
  background: var(--glass);
  border: 1px solid var(--hair);
  border-radius: var(--r);
  box-shadow: 0 2px 0 rgba(255,255,255,.04) inset, 0 12px 32px rgba(0,0,0,.45);
  backdrop-filter: blur(var(--blur)) saturate(var(--sat));
}
.card{padding:12px}
.timeline{display:flex;flex-direction:column;gap:10px}
.row{
  display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;
  background:rgba(255,255,255,.02);border:1px solid var(--hair);border-radius:14px;padding:12px;
}
.badge{
  font-size:12px;padding:6px 8px;border-radius:10px;white-space:nowrap;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid var(--hair);
}
.title{font-weight:700}
.sub{font-size:12px;color:var(--muted)}
.tag{display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border-radius:999px;font-size:12px;background:rgba(255,255,255,.03); border:1px solid var(--hair)}
.dot{width:10px;height:10px;border-radius:50%;border:1px solid var(--hair)}
.dot.work{background:#7f8cff}.dot.study{background:#7ad3a6}.dot.health{background:#ff8a8a}.dot.errand{background:#ffd27a}.dot.default{background:#d2c2ff}.dot.other{background:#d892e5}
.muted{color:var(--muted);text-align:center;padding:10px}
.grid-week{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.day{border:1px solid var(--hair);border-radius:14px;padding:10px;background:rgba(255,255,255,.02)}
.day h3{margin:0 0 6px 0;font-size:12px;color:var(--muted)}
.day .pill{display:block;margin:6px 0;padding:6px 8px;border-radius:10px;border:1px solid var(--hair);font-size:12px;background:rgba(255,255,255,.02)}
.nav{position:fixed;left:0;right:0;bottom:12px;display:flex;gap:10px;justify-content:center}
.nav-btn{
  min-width:98px;background:rgba(255,255,255,.03);border:1px solid var(--hair);color:var(--ink);
  padding:10px 12px;border-radius:999px;backdrop-filter: blur(10px) saturate(130%);
}
.nav-btn.active{box-shadow:0 0 0 2px rgba(176,107,243,.35)}
.fab{
  position:fixed;right:16px;bottom:88px;width:58px;height:58px;border-radius:50%;border:none;
  color:#120816;font-size:28px;font-weight:800;
  background: radial-gradient(120% 120% at 80% 10%, var(--acc2), var(--acc));
  box-shadow:0 12px 26px rgba(0,0,0,.6), 0 0 24px rgba(176,107,243,.45), inset 0 1px 0 rgba(255,255,255,.3);
}

/* === Bottom Panel Modal (not full-screen) === */
.modal{
  position:fixed;inset:0;display:grid;place-items:end;background:rgba(0,0,0,.55); /* dim backdrop */
}
.modal.hidden{display:none}
.sheet{
  width:100%;max-width:960px; /* panel width */
  max-height:70vh;           /* key: do not cover full screen */
  overflow:auto;             /* scroll if content long */
  border-top-left-radius:22px;border-top-right-radius:22px;
  position:relative;
}
/* removed glitchy grabber */
.sheet-head{position:sticky;top:0;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--hair);background:rgba(0,0,0,.35);backdrop-filter: blur(8px) saturate(140%)}
.sheet-head h2{margin:0;font-size:16px}
.icon{background:transparent;border:1px solid var(--hair);color:var(--muted);padding:8px 12px;border-radius:12px}
.form{padding:12px 14px;display:grid;gap:12px}
.form label{display:flex;flex-direction:column;gap:6px;font-size:13px;color:var(--muted)}
.form input,.form textarea,.form select{
  background:rgba(255,255,255,.03);color:var(--ink);border:1px solid var(--hair);border-radius:12px;padding:12px 14px;outline:none
}
.form input:focus,.form textarea:focus,.form select:focus{
  border-color:transparent; box-shadow:0 0 0 2px rgba(240,90,166,.28), 0 0 28px rgba(240,90,166,.18) inset;
}
.row2{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr);gap:12px}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0}
.chip{border:1px solid var(--hair);background:rgba(255,255,255,.02);color:var(--ink);padding:8px 12px;border-radius:999px;font-size:13px}
.chip.active{box-shadow:0 0 0 2px rgba(176,107,243,.35) inset}
.custom{margin-top:6px}
.sheet-foot{position:sticky;bottom:0;z-index:2;display:flex;align-items:center;gap:10px;padding:12px 14px;border-top:1px solid var(--hair);background:rgba(0,0,0,.35);backdrop-filter: blur(8px) saturate(140%)}
.primary{
  background:linear-gradient(180deg, var(--acc), var(--acc2));
  border:1px solid rgba(255,255,255,.18); color:#16081d; padding:12px 16px;border-radius:12px;font-weight:800
}
.ghost{background:transparent;border:1px solid var(--hair);color:var(--ink);padding:12px 16px;border-radius:12px}
.ghost.danger{border-color:#ff8a8a;color:#ffb3b3}
.toast{position:fixed;bottom:150px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,.06);border:1px solid var(--hair);color:var(--ink);padding:10px 14px;border-radius:12px;opacity:0;transition:opacity .2s;backdrop-filter: blur(10px) saturate(130%)}
.toast.show{opacity:1}
@media (max-width:720px){.search{max-width:60vw}.row2{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr);gap:12px}}

/* row2 tight */
.row2 label{min-width:0}
.row2 input{min-width:0}

.sheet-head:after{
  content:"";
  display:block;
  margin:6px auto 0;
  height:4px; width:44px; border-radius:999px;
  background:linear-gradient(90deg, rgba(176,107,243,.6), rgba(240,90,166,.6));
  opacity:.55;
}

/* row2 stable */
.row2 label{min-width:0;width:100%}
.row2 input,.row2 select{min-width:0;width:100%}

/* row2 override guard */
.form .row2{grid-template-columns:minmax(0,1fr) minmax(0,1fr) !important}


/* Hide + button glow while panel open */
.modal-open .fab{
  opacity:0;
  pointer-events:none;
  transform:scale(.95);
  box-shadow:none;
  filter:none;
}


/* ===== NoirPlan: header/close alignment + safe grabber ===== */

/* Make header a positioned container and give room for the X */
.sheet-head{
  position: sticky;
  top: 0;
  padding: 14px 52px 10px 16px; /* extra right padding for the X */
}

/* Center the title and prevent it from colliding with the X */
.sheet-head h2{
  text-align: center;
  margin: 0;
  padding: 0;
}

/* Anchor the X to the top-right corner */
.sheet-head .icon{
  position: absolute;
  right: 12px;
  top: 10px;
}

/* Replace the old in-flow grabber with an absolutely centered one */
.sheet-head:after{
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  top:6px;
  height:4px;
  width:44px;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(176,107,243,.6), rgba(240,90,166,.6));
  opacity:.55;
  pointer-events:none;
}

/* Ensure the sheet can host absolutely positioned header items */
.sheet{ position:relative; }


/* 1px per minute: 24h = 1440px */
  border:1px solid var(--hair);
  border-radius:14px;
  overflow:hidden;
  background:rgba(255,255,255,.02);
}
.timeline-hours{
  position:absolute; inset:0;
}
.timeline-hour{
  position:absolute; left:0; right:0; height:0;
  border-top:1px dashed rgba(255,255,255,.08);
}
.timeline-hour .label{
  position:absolute; left:8px; top:-8px;
  font-size:11px; color:var(--muted);
  background:rgba(0,0,0,.45);
  padding:2px 6px; border-radius:8px;
  border:1px solid var(--hair);
  backdrop-filter: blur(6px) saturate(130%);
}
.now-line{
  position:absolute; left:0; right:0; height:0;
  border-top:2px solid rgba(240,90,166,.8);
  filter: drop-shadow(0 0 6px rgba(240,90,166,.45));
}
.ev-block{
  position:absolute; left:8px; right:8px;
  border:1px solid var(--hair);
  border-radius:12px;
  padding:8px 10px;
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow:0 8px 18px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
  overflow:hidden;
}
.ev-block .t{font-weight:700}
.ev-block .s{font-size:12px;color:var(--muted)}
.ev-tag{
  display:inline-flex; align-items:center; gap:6px;
  font-size:12px; padding:2px 8px; margin-right:6px;
  border:1px solid var(--hair); border-radius:999px;
  background:rgba(255,255,255,.04);
}
.ev-tag .dot{width:8px;height:8px;border-radius:50%;border:1px solid var(--hair)}
/* slight horizontal offset when overlapping */
.ev-offset-1{ left:20px; right:8px }
.ev-offset-2{ left:32px; right:8px }

/* ===== NoirPlan: Compact Timeline (720px / day) ===== */
.timeline-wrap{ position:relative; }
.timeline-card{
  position:relative;
  border:1px solid var(--hair);
  border-radius:14px;
  overflow:hidden;
  background: rgba(255,255,255,.02); /* neutral frosted */
  box-shadow:0 10px 26px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
  backdrop-filter: blur(var(--blur)) saturate(var(--sat));

  box-shadow:0 10px 26px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
  backdrop-filter: blur(var(--blur)) saturate(var(--sat));
}

/* Grid background: hour + half-hour ticks */
.timeline-grid{
  height:  1440px; /* 24h * 30px */
  position:relative;
  background:
    repeating-linear-gradient(to bottom, rgba(255,255,255,.05) 0px, rgba(255,255,255,.05) 1px,
      transparent 1px,
      transparent 30px
    ),
    repeating-linear-gradient(to bottom, rgba(255,255,255,.03) 0px, rgba(255,255,255,.03) 1px,
      transparent 1px,
      transparent 15px
    );
}

/* Hour labels */
.tl-hour{
  position:absolute; left:8px; height:0;
  border-top:1px dashed rgba(255,255,255,.08);
}
.tl-hour .lab{
  position:absolute; top:-8px; left:0;
  font-size:11px; color:var(--muted);
  background:rgba(0,0,0,.45);
  padding:1px 6px; border-radius:8px;
  border:1px solid var(--hair);
  backdrop-filter: blur(6px) saturate(130%);
}

/* Now line */
.tl-now{
  position:absolute; left:0; right:0; height:0;
  border-top:2px solid rgba(240,90,166,.85);
  filter: drop-shadow(0 0 6px rgba(240,90,166,.45));
}

/* Event blocks (compact) */
.ev2{}
.ev2 .t{font-weight:700; font-size:13px; line-height:1.1}
.ev2 .s{font-size:11px; color:var(--muted); margin-top:2px}

/* Accent colors by tag */
.ev2.work{ --ev-accent:#7f8cff; }
.ev2.study{ --ev-accent:#7ad3a6; }
.ev2.health{ --ev-accent:#ff8a8a; }
.ev2.errand{ --ev-accent:#ffd27a; }
.ev2.default{ --ev-accent:#d2c2ff; }
.ev2.other{ --ev-accent:#d892e5; }

/* Lanes */
.ev-lane-0{ left:8px; }
.ev-lane-1{ }
.ev-lane-2{ }
.ev-lane-3{ }
.ev-lane-4{ }

/* Head row above timeline */
.timeline-head{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px 8px 12px;
}
.timeline-head .legend{ display:flex; gap:8px; align-items:center; color:var(--muted); font-size:12px }
.legend .chip{
  display:inline-flex; align-items:center; gap:6px; padding:4px 8px;
  border:1px solid var(--hair); border-radius:999px; background:rgba(255,255,255,.03);
}
.legend .dot{ width:8px; height:8px; border-radius:50%; border:1px solid var(--hair) }
.legend .dot.work{background:#7f8cff}.legend .dot.study{background:#7ad3a6}.legend .dot.health{background:#ff8a8a}.legend .dot.errand{background:#ffd27a}.legend .dot.default{background:#d2c2ff}


/* --- Timeline gutter & comfy event blocks --- */
.timeline-grid{ padding-left:64px; }            /* left gutter so labels & events never clash */
.tl-hour .lab{ left:12px; }                     /* label sits within the gutter */

.ev2{}

/* ev2 layout fix removed */
.ev2{
  display:flex;
  flex-direction:column;
  justify-content:center;    /* vertical centering */
  padding: 8px 12px 8px 20px; /* balanced padding */
  min-height:26px;
  line-height:1.3;
  white-space:normal;
  
}
.ev2 .t{font-weight:600; font-size:13px; line-height:1.2; margin:0;}
.ev2 .s{font-size:11px; color:var(--muted); margin-top:2px;}

/* Better vertical centering for timeline events */
.ev2{
  display:flex;
  position:relative;
  padding: 8px 12px 8px 20px;   /* no vertical padding, rely on centering */
  line-height:1.3;
  overflow:hidden;
}
.ev2-content{
  margin:auto 0;           /* vertical centering inside block */
  width:100%;
}
.ev2 .t{font-weight:600; font-size:13px; line-height:1.2; margin:0;}
.ev2 .s{font-size:11px; color:var(--muted); margin:2px 0 0 0;}


/* === FIX: event container visuals + centered content === */
.ev2{
  position:absolute;
  border:1px solid var(--hair);
  border-radius:12px;
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow:
    0 8px 18px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.06);
  display:flex;
  flex-direction:column;
  justify-content:center;
  padding: 8px 12px 8px 20px;   /* a touch more padding */
  min-height:36px;             /* bigger floor so text fits */
  line-height:1.25;
  overflow:hidden;
  white-space:normal;
  
}
.ev2-content{ margin:auto 0; width:100%; }
.ev2 .t{
  font-weight:600; font-size:12.5px; line-height:1.2; margin:0;
  display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:2; overflow:hidden;
}
.ev2 .s{
  font-size:10.5px; color:var(--muted); margin-top:2px;
  display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:1; overflow:hidden;
}
/* accent colors */
.ev2.work{   --ev-accent:#7f8cff; }
.ev2.study{  --ev-accent:#7ad3a6; }
.ev2.health{ --ev-accent:#ff8a8a; }
.ev2.errand{ --ev-accent:#ffd27a; }
.ev2.default{--ev-accent:#d2c2ff; }
.ev2.other{  --ev-accent:#d892e5; }
.ev2.study{  --ev-accent:#7ad3a6; }
.ev2.health{ --ev-accent:#ff8a8a; }
.ev2.errand{ --ev-accent:#ffd27a; }
.ev2.default{--ev-accent:#d2c2ff; }
.ev2.other{  --ev-accent:#d892e5; }


/* Replace FAB with top-right Add button */
.fab{display:none !important}


/* Header row above timeline */
.section-head{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:8px; gap:10px;
}

/* Add button (same colours as FAB) */
.btn-add{
  appearance:none; border:none; cursor:pointer;
  padding:10px 14px; border-radius:12px; font-weight:800;
  color:#16081d;
  background: radial-gradient(120% 120% at 80% 10%, var(--acc2), var(--acc));
  box-shadow:
    0 10px 22px rgba(0,0,0,.45),
    0 0 20px rgba(176,107,243,.35),
    inset 0 1px 0 rgba(255,255,255,.35);
  border:1px solid rgba(255,255,255,.18);
}
.btn-add:active{ transform: translateY(1px); }


/* === Activity input with emoji button === */
.input-emoji{ position:relative; }
.input-emoji input{
  width:100%;
  padding-left:42px; /* room for emoji button */
}
.emoji-btn{
  position:absolute; left:8px; top:50%; transform:translateY(-50%);
  width:28px; height:28px; border-radius:10px;
  border:1px solid var(--hair); background:rgba(255,255,255,.06); color:var(--ink);
  display:grid; place-items:center; font-size:16px; line-height:1;
  backdrop-filter: blur(8px) saturate(140%);
}
.emoji-btn:active{ transform:translateY(-50%) scale(.98); }

.emoji-picker{
  position:absolute; left:0; top:calc(100% + 8px); z-index:20;
  width:min(280px, 92vw);
  padding:8px; border:1px solid var(--hair); border-radius:12px;
  background:rgba(0,0,0,.6); backdrop-filter: blur(12px) saturate(150%);
  box-shadow:0 12px 28px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.05);
}
.emoji-picker.hidden{ display:none; }
.emoji-grid{ display:grid; grid-template-columns:repeat(8,1fr); gap:6px; }
.emoji-item{
  width:32px; height:32px; border-radius:10px;
  border:1px solid var(--hair); background:rgba(255,255,255,.05); color:var(--ink);
  display:grid; place-items:center; font-size:18px; cursor:pointer;
}
.emoji-item:active{ transform:scale(.95); }


/* === Emoji button centering === */
.emoji-btn{
  padding:0;                 /* no default button inset */
  text-align:center;
  font-size:20px;            /* clearer centering */
  line-height:1;             /* no extra baseline space */
  width:30px; height:30px;   /* perfect square */
  display:grid; place-items:center;
}

/* Timeline event title with emoji */
.ev2 .t{ display:flex; align-items:center; gap:6px }
.ev2 .t .em{ flex:0 0 auto; font-size:14px; line-height:1; }

/* === Detail page === */
.detail-wrap{ display:grid; gap:12px; }
.detail-card{
  padding:14px;
  border:1px solid var(--hair);
  border-radius:14px;
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow:0 12px 28px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06);
  backdrop-filter: blur(var(--blur)) saturate(var(--sat));
}
.detail-head{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.btn{ appearance:none; border:1px solid var(--hair); background:transparent; color:var(--ink); padding:10px 14px; border-radius:12px; }
.btn.primary{ background:linear-gradient(180deg, var(--acc), var(--acc2)); color:#16081d; border-color:rgba(255,255,255,.18); font-weight:800 }
.btn.danger{ border-color:#ff8a8a; color:#ffb3b3 }
.detail-grid{ display:grid; gap:8px; }
.detail-row{ display:flex; gap:8px; align-items:center; color:var(--muted); font-size:13px }
.detail-row b{ color:var(--ink); font-weight:700; margin-right:6px }
.back-row{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }


/* Emoji button shows current emoji */
.emoji-btn{
  font-size:20px; line-height:1; text-align:center;
}


/* === Quick Activity templates (chips) === */
.quick-templates{
  display:flex; flex-wrap:wrap; gap:8px; margin:6px 0 10px 0;
}
.tpl-btn{
  appearance:none; cursor:pointer;
  border:1px solid var(--hair);
  background:rgba(255,255,255,.04);
  color:var(--ink);
  padding:8px 12px;
  border-radius:12px;
  font-size:13px;
  display:flex; align-items:center; gap:8px;
  backdrop-filter: blur(10px) saturate(130%);
}
.tpl-btn:active{ transform:translateY(1px); }

/* ev2 text wrapping */
.ev2 .t{
  white-space: normal;
            /* don't split "Bowel" */
  overflow-wrap: break-word;   /* wrap long words only if needed */
  hyphens: auto;
}
.ev2 .s{
  white-space: normal;
  
  overflow-wrap: break-word;
  hyphens: auto;
}


/* === Fix: left-edge clipping on event titles === */
.timeline-grid .ev2{
  padding:8px 12px 8px 26px !important;   /* more left padding so B isn't under the accent */
}
  /* tiny buffer */
.timeline-grid .ev2 .t,
.timeline-grid .ev2 .s{
  display:block;                 /* kill any old -webkit-box clamp flex side effects */
  white-space:normal;
  word-break:normal;
  overflow-wrap:break-word;
  hyphens:auto;
  overflow:visible;              /* ensure glyph edges don't get clipped */
}
/* if older rules forced clamps, neutralize them */
.timeline-grid .ev2 .t{
  -webkit-line-clamp:unset; -webkit-box-orient:unset;
}


/* === Fix: left-edge clipping on event titles (final) === */
.timeline-grid .ev2{
  box-sizing:border-box !important;
  padding:10px 12px 10px 32px !important;  /* bigger left inset */
  overflow:visible !important;             /* don't shave first glyph */
}

.timeline-grid .ev2 .t{
  text-indent:0 !important;
  white-space:normal !important;
  word-break:normal !important;
  overflow-wrap:break-word !important;
  hyphens:auto !important;
  -webkit-line-clamp:unset !important; -webkit-box-orient:unset !important;
}


/* === RESET: keep text inside cards + fix first-letter clipping === */
.timeline-grid .ev2{
  box-sizing:border-box !important;
  /* Border(1) + accent inset(3) + inner gap(12) = 16 → use 20 for comfort */
  padding:8px 12px 8px 20px !important;
  overflow:hidden !important;          /* keep content inside */
  border-radius:12px !important;       /* ensure mask matches card */
}


/* Text: wrap at spaces, only break long words if needed; stay inside */
.timeline-grid .ev2 .t,
.timeline-grid .ev2 .s{
  white-space:normal !important;
  word-break:normal !important;
  overflow-wrap:break-word !important;
  hyphens:auto !important;
  margin:0 !important;
}

/* Gentle line clamps so tall notes don’t overflow the card */
.timeline-grid .ev2 .t{
  display:-webkit-box !important;
  -webkit-box-orient:vertical !important;
  -webkit-line-clamp:2 !important;
  overflow:hidden !important;
}
.timeline-grid .ev2 .s{
  display:-webkit-box !important;
  -webkit-box-orient:vertical !important;
  -webkit-line-clamp:1 !important;
  overflow:hidden !important;
}


/* === Keep activity titles on a single line === */
.timeline-grid .ev2 .t{
  white-space:nowrap !important;   /* never break words in the title */
  overflow:hidden !important;      /* cut off if too long for the box */
  text-overflow:ellipsis !important; /* show … if truncated */
}


/* === Timeline event emoji logo on the left === */
.timeline-grid .ev2{
  padding:8px 12px 8px 44px !important;  /* room for the logo chip */
}
.ev2 .emlogo{
  position:absolute; left:12px; top:50%; transform:translateY(-50%);
  width:28px; height:28px; border-radius:10px;
  display:grid; place-items:center; font-size:18px; line-height:1;
  border:1px solid var(--hair);
  background:rgba(255,255,255,.06);
  backdrop-filter: blur(8px) saturate(140%);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 4px 10px rgba(0,0,0,.25);
}
/* optional: tint the chip border a bit per tag */
.ev2.work   .emlogo{ box-shadow: 0 4px 10px rgba(0,0,0,.25), 0 0 0 1px #7f8cff55 inset; }
.ev2.study  .emlogo{ box-shadow: 0 4px 10px rgba(0,0,0,.25), 0 0 0 1px #7ad3a655 inset; }
.ev2.health .emlogo{ box-shadow: 0 4px 10px rgba(0,0,0,.25), 0 0 0 1px #ff8a8a55 inset; }
.ev2.errand .emlogo{ box-shadow: 0 4px 10px rgba(0,0,0,.25), 0 0 0 1px #ffd27a55 inset; }


/* === Timeline event: accent bar + emoji chip === */
.timeline-grid .ev2{
  position:relative;
  box-shadow: inset 3px 0 0 var(--accent), 0 2px 6px rgba(0,0,0,.25);
  padding:8px 12px 8px 44px; /* room for logo on the left */
}
.ev2 .emlogo{
  position:absolute; left:6px; top:50%; transform:translateY(-50%);
  width:28px; height:28px;
  border-radius:50%;
  display:grid; place-items:center;
  font-size:18px; line-height:1;
  background:rgba(255,255,255,.08);
  border:1px solid var(--hair);
  backdrop-filter: blur(8px) saturate(140%);
}

/* === ENFORCE: accent bar + emoji chip on timeline entries === */
.timeline-grid .ev2{
  /* keep the colored left embed */
  box-shadow:
    inset 3px 0 0 var(--ev-accent, #d2c2ff),
    0 8px 18px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.06) !important;
  padding:8px 12px 8px 44px !important;  /* room for the emoji chip */
  position: absolute; /* keep timeline positioning */
}

/* circular emoji chip, centered left */
.timeline-grid .ev2 .emlogo{
  position:absolute; left:10px; top:50%; transform:translateY(-50%);
  width:28px; height:28px; border-radius:50%;
  display:grid; place-items:center;
  font-size:18px; line-height:1;
  border:1px solid var(--hair);
  background:rgba(255,255,255,.08);
  backdrop-filter: blur(8px) saturate(140%);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 4px 10px rgba(0,0,0,.25);
}

/* title stays single-line, no emoji inside */
.timeline-grid .ev2 .t{
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}


/* === Darker emoji chip === */
.timeline-grid .ev2 .emlogo{
  background:rgba(0,0,0,.25) !important;   /* darker background */
  border:1px solid rgba(255,255,255,.1) !important;
}


/* === Darkest emoji chip === */
.timeline-grid .ev2 .emlogo{
  background:rgba(0,0,0,.45) !important;   /* much darker */
  border:1px solid rgba(255,255,255,.08) !important;
}


/* === Timeline event meta row: time always visible === */
.timeline-grid .ev2 .meta{
  display:flex; align-items:center; gap:8px;
}
.timeline-grid .ev2 .tm{
  flex:0 0 auto;                 /* never shrink the time */
  font-size:11px;
  white-space:nowrap;             /* keep 06:00–06:40 intact */
  color:var(--muted);
}
.timeline-grid .ev2 .notes{
  flex:1 1 auto; min-width:0;     /* allow shrink/truncate */
  font-size:11px; color:var(--muted);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* keep title on one line with ellipsis */
.timeline-grid .ev2 .t{
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}



.timeline-grid .ev2 .t{
  flex:0 0 auto;                 /* don’t shrink */
  font-weight:500;
  font-size:13px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  margin-bottom:2px;
}

/* make title+meta a vertical stack */



/* ====================== HORIZONTAL TIMELINE ====================== */
.htl-card{ border:1px solid var(--hair); border-radius:14px; overflow:hidden;
  background:rgba(255,255,255,.02); box-shadow:0 10px 26px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
  backdrop-filter: blur(var(--blur)) saturate(var(--sat)); }

.htl-wrap{ overflow-x:auto; overflow-y:hidden; -webkit-overflow-scrolling:touch; }
.htl{ position:relative; min-height:120px; padding-top:36px; }  /* room for the hour ruler */
.htl .ruler{ position:absolute; left:0; top:0; height:36px; right:0; }
.htl .ruler .hmark{ position:absolute; top:0; height:100%; width:1px; background:rgba(255,255,255,.07); }
.htl .ruler .hlabel{ position:absolute; top:2px; transform:translateX(-50%); font-size:11px; color:var(--muted); }

.htl .gridline{ position:absolute; top:36px; bottom:0; width:1px; background:rgba(255,255,255,.04); }
.htl .halfhour{ background:rgba(255,255,255,.02); }

.htl .lane{ position:relative; height:42px; } /* each lane row */
.hev{ position:absolute; top:6px; height:30px; border-radius:12px; padding:0 10px 0 42px; display:flex; align-items:center; gap:8px;
  border:1px solid var(--hair);
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 8px 18px rgba(0,0,0,.35);
  white-space:nowrap; overflow:hidden; }

.hev .logo{ position:absolute; left:8px; top:50%; transform:translateY(-50%); width:24px; height:24px; border-radius:50%;
  display:grid; place-items:center; font-size:16px; line-height:1;
  background:rgba(0,0,0,.5); border:1px solid rgba(255,255,255,.08);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 4px 10px rgba(0,0,0,.25); }

.hev .title{ font-size:13px; overflow:hidden; text-overflow:ellipsis; }
.hev .tm{ font-size:11px; color:var(--muted); flex:0 0 auto; margin-left:auto; padding-left:8px; }

.hev.work{   --ev-accent:#7f8cff; }
.hev.study{  --ev-accent:#7ad3a6; }
.hev.health{ --ev-accent:#ff8a8a; }
.hev.errand{ --ev-accent:#ffd27a; }
.hev.default{--ev-accent:#d2c2ff; }
.hev.other{  --ev-accent:#d892e5; }

/* subtle top accent by tag (thin line) */
.hev:before{ content:''; position:absolute; left:0; right:0; top:0; height:2px; border-top-left-radius:12px; border-top-right-radius:12px; background:var(--ev-accent, #d2c2ff); opacity:.7; }
